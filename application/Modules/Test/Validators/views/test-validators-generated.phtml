<?php
namespace JetApplicationModule\Test\Validators;

use Jet\MVC_View;
use Jet\Tr;
use Jet\UI_messages;

/**
 * @var MVC_View $this
 * @var EntityTest_Entity $test_object
 */

$test_object = $this->getRaw( 'test_object' );


$validator = $test_object->createValidator();

$validator->validate();

?>
<h2><?= Tr::_( 'Validator test - generated by definition' ) ?></h2>

<table class="table table-striped">
	<?php foreach($validator->getValidators() as $validator): ?>
	<tr>
		<td><?=$validator->getPropertyPath()?></td>
		<td>
			<?php if(!$validator->getAllErrors()):
				echo UI_messages::createSuccess(Tr::_('Valid'))->setCloseable(false);
			else:
				echo UI_messages::createInfo(Tr::_('Invalid'))->setCloseable(false);
				?>
				<table class="table table">
					<?php foreach($validator->getAllErrors() as $error): ?>
						<tr>
							<td><?=Tr::_('Code:')?></td>
							<td><?=$error->getCode()?></td>
						</tr>
						<tr>
							<td><?=Tr::_('Message:')?></td>
							<td><?=$error->getMessage()?></td>
						</tr>
						<tr>
							<td><?=Tr::_('Data:')?></td>
							<td><pre><?php var_dump($error->getErrorData())?></pre></td>
						</tr>
					<?php endforeach; ?>
				</table>
			<?php endif; ?>
		</td>
	</tr>
	<?php endforeach; ?>
</table>
